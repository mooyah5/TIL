# 0417 TIL Django DB



### 1. Foreign Key

- 개념
  - 외래 키 (외부 키)
  - RDB(관계형 데이터베이스)에서 한 테이블이 다른(부모) 테이블의 행을 식별할 수 있도록 하는 키
  - 참조하는 테이블인 외래 키는 참조되는 테이블의 기본키를 가리킴
  - 참조하는 테이블(N)의 1행 값은, 참조되는 테이블의 행 값에 대응되므로, 참조하는 테이블의 행에는 참조되는 테이블에 없는 값을 포함할 수 없다.
- 특징
  - 참조 무결성 : 키를 사용해서 부모 테이블의 유일한 값을 참조한다.
  - 외래 키의 값이 반드시 부모 테이블의 기본 키일 필요는 없으나, 유일해야 한다.



### 2. ForeignKey model field

- A-many-to-one relationship
- 2개의 필수 위치 인자 필요
  1. 참조하는 model class
  2. on_delete 옵션
     - 외래 키가 참조하는 객체가 사라졌을 때, 외래 키를 가진 객체를 어떻게 처리할지 정의
     - 데이터 무결성(Database Integrity)을 위해 매우 중요한 설정
     - 옵션
       - CASCADE : 부모 객체(참조 된 객체가 삭제 됐을 때, 이를 참조하는 객체도 삭제)
       - PROTECT : 참조가 되어있는 경우 오류 발생
       - SET_NULL : 부모 객체 삭제 시 모든 객체를 NULL로 치환 (NOT NULL 조건 시 불가)
       - SET_DEFAULT : 모든 값을 미리 지정해둔 기본값으로 치환 (default 설정이 있어야 함, DB에서는 보통 없으면 null로 잡기도 한다.(장고 제외))
       - SET() : 특정 함수 호출
       - DO_NOTHING : 아무짓도 하지 않음
         - BUT, 데이터베이스 필드에 대한 SQL`on_delete`제한 조건을 설정해야 함
       - RESTRICT : RestrictedError를 발생시켜 참조된 객체의 삭제를 방지



### 3. 데이터 무결성

- 데이터 무결성이란?
  - 데이터 정확성과 일관성을 유지, 보증하는 것
  - DB나 RDBMS 시스템의 중요 기능
- 유형
  1. 개체 무결성 (Entity Integrity)
     - PK 개념과 관련
     - 모든 테이블이 PK를 가져야 함
     - PK로 선택된 열은 고유한 값이어야 함
     - 빈 값은 허용치 않음
  2. 참조 무결성 (referential Integrity)
     - FK(외래 키) 개념과 관련
     - FK 값이 데이터베이스의 특정 테이블의 PK 값을 참조하는 것
  3. 범위(도메인) 무결성 (Domain Integrity)
     - 정의된 형식(범위)에서 관계형 데이터베이스의 모든 컬럼이 선언되도록 규정





